<section class="panel panel--surface">
  <header class="panel__header">
    <div>
      <h2 class="panel__title">cart summary</h2>
      <p class="panel__subtitle">
        Adjust quantities or remove items. Offers update automatically.
      </p>
    </div>
  </header>

  @if (itemCount > 0) {

  <div class="cart-table">
    <div class="cart-table__head">
      <div class="cart-table__cell cart-table__cell--head">
        Item
      </div>

      <div class="cart-table__cell cart-table__cell--head cart-table__col--qty">
        Quantity
      </div>

      <div class="cart-table__cell cart-table__cell--head cart-table__col--unit">
        Unit Price (€)
      </div>

      <div class="cart-table__cell cart-table__cell--head cart-table__col--total">
        Total (€)
      </div>

      <div class="cart-table__cell cart-table__cell--head cart-table__remove"></div>
    </div>

    <div class="cart-table__body">
      @for (row of rows; track row.sku) {
      <div class="cart-table__row">

        <div class="cart-table__cell cart-table__cell--main">
          <div class="cart-table__item-name">
            {{ row.name }}
          </div>

          <div class="cart-table__item-meta">
            @if (row.offerApplied) {
            <span class="badge">Offer applied</span>
            } @else {
            <span class="badge badge--muted">Standard price</span>
            }
          </div>
        </div>

        <div class="cart-table__cell cart-table__col--qty">
          <button type="button" class="qty-btn" (click)="decrement(row.sku)" [disabled]="row.quantity === 1"
            aria-label="Decrease quantity">
            −
          </button>

          <span class="qty-value">{{ row.quantity }}</span>

          <button type="button" class="qty-btn qty-btn--plus" (click)="increment(row.sku)"
            aria-label="Increase quantity">
            +
          </button>
        </div>

        <div class="cart-table__cell cart-table__col--unit">
          €{{ row.unitPrice }}
        </div>

        <div class="cart-table__cell cart-table__col--total">
          €{{ row.lineTotal }}
        </div>

        <div class="cart-table__cell cart-table__remove">
          <button type="button" class="btn-icon btn-icon--danger" (click)="remove(row.sku)" aria-label="Remove item">
            ✕
          </button>
        </div>

      </div>
      }
    </div>
  </div>

  <div class="totals">
    <div class="totals__row">
      <span>Subtotal</span>
      <span>€{{ totals.subtotal }}</span>
    </div>

    @if (totals.discount > 0) {
    <div class="totals__row">
      <span>Discount from offers</span>
      <span class="totals__discount">-{{ totals.discount }}€</span>
    </div>

    <div class="totals__spacer"></div>
    } @else {
    <div class="totals__spacer"></div>
    }

    <div class="totals__row totals__row--emphasis">
      <span>Total</span>
      <span>€{{ totals.total }}</span>
    </div>
  </div>

  <div class="summary-footer">
    <div class="summary-footer__meta">
      <span class="summary-footer__label">Items in cart</span>
      <span class="summary-footer__value">{{ itemCount }}</span>
    </div>

    <button type="button" class="btn btn--ghost" (click)="clear()">
      Clear shopping cart
    </button>
  </div>

  } @else {

  <div class="empty-state">
    <h3>No items yet</h3>
    <p>Start by adding a product to see the pricing breakdown.</p>
  </div>

  }
</section>